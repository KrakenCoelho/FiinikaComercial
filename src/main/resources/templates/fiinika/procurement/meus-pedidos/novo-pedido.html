<!DOCTYPE html><!--  Last Published: Fri Jul 12 2024 13:58:39 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="668fab4d664315feab7fea19" data-wf-site="667ada12e2b008b7d4b9eee9">
<head>
  <meta charset="utf-8">
  <title>Novo pedido</title>
  <meta content="Novo pedido" property="og:title">
  <meta content="Novo pedido" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <link href="../../../css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../../../css/components.css" rel="stylesheet" type="text/css">
  <link href="../../../css/fiinika-comercial-app.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Inter:300,regular,500,600,700","Barlow:100,200,300,regular,500,600,700,800,900"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="../../../images/favicon.png" rel="shortcut icon" type="image/x-icon">
  <link href="../../../images/webclip.png" rel="apple-touch-icon">
  

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.1/dist/sweetalert2.min.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.1/dist/sweetalert2.min.js"></script>
  
</head>
<body>
  <div class="mother-div">
    <div class="html-embed w-embed"></div>
    <div class="close-flyout"></div>
    <div class="page-content-wrapper">
    <div th:insert="/fragments/menuAdmin :: menuAdmin"></div>  
      <div class="content">
        <section class="criar-page-section container">
          <div class="container">
            <div class="form-wrapper w-form">
              <div class="top-section-navigation">
                <a href="javascript:history.back()" class="seta-para-tras w-inline-block">
                  <div class="text-block-129">q</div>
                </a>
                <div class="titulo">
                  <div class="text-block-130">Novo pedido<br></div>
                </div>
              </div>
              <form th:action="'/savepedido'"  id="wf-form-Criar-Fatura" name="wf-form-Criar-Fatura" data-name="Criar Fatura" method="POST" class="form" data-wf-page-id="668fab4d664315feab7fea19" data-wf-element-id="e4cdf306-296b-3b25-3313-87c14bc3c666">
                <div class="form-section tighter">
                  <div class="criar-content-wrapper">
                  <div class="form-field-wrapper">
                    
                    <label for="field-3" class="form-field-lable">Nome </label>
                    <input required id="field-3" name="NomePedido" data-name="Field 3" type="text" class="form-text-field w-select">
                     
                      </div>
                    <div class="form-field-wrapper">
                    
                    <label for="field-3" class="form-field-lable">Data de início do concurso</label>
                    <input required id="field-3" name="dIC" data-name="Field 3" type="date" class="form-text-field w-select">
                     
                      </div>
                       <input required id="field-3" name="empresaIdFK"  th:value="${idEmpresa}" data-name="Field 3" type="hidden" class="form-text-field w-select">
                    <div class="form-field-wrapper">
                    <label for="field-5" class="form-field-lable">Data de fecho do concurso</label>
                    <input id="f3"  data-name="Field 3" name="dFC"  type="date" class="form-text-field w-select">
<!--                     <input id="3f" type="text"    > -->
                    </div>
                    <div class="form-field-wrapper"><label for="name" class="form-field-lable">Sectores</label>
                      <div class="text-block-142">O seu pedido será apresentado à empresas inscritas nestes sectores. Por favor tenha atenção com esta escolher uma vez que a mesma determinará a qualidade das propostas que receberá.</div>
                      <select required  onclick="myFunction('myDIV')"  id="multiplosectores" name="sectores" data-name="Field 3" class="form-text-field w-select">
						  <option value="">Selecionar</option>                       
                        <option th:each="s:${todos}" th:value="${s.idSector}">[[${s.sector}]]</option>
                      </select>
                      <div class="div-block-127" id="myDIV" style="display: none">
                        <div class="w-layout-grid grid-15" id="sectores_selected">
                          
                        </div>
                         <div id="selecionadas"  style="display: none" >  
                         
                     </div>
                      </div>
                    </div>
                    <div class="form-field-wrapper"><label for="name" class="form-field-lable">Descrição dos produtos/serviços que precisas</label>
                      <div class="text-block-142">Por favor descreva: nome, preço, quantidade dos serviços ou produtos que precisa</div>
                      <textarea  required placeholder="Example Text" maxlength="5000" id="descricao" name="descricao" data-name="Field 4" class="form-text-field _3 w-input"></textarea>
                    </div>
                    <div class="create-div">
                      <a onclick="criar();" class="button main w-button">Enviar</a>
                        <input id="submit" type="submit" style="display:none;" value="Enviar"/>
                    </div>
                    <div class="se-funcionarios_especificos"></div>
                  </div>
                </div>
              </form>
              <div class="w-form-done">
                <div>Thank you! Your submission has been received!</div>
              </div>
              <div class="w-form-fail">
                <div>Oops! Something went wrong while submitting the form.</div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=667ada12e2b008b7d4b9eee9" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="/js/fiinika-comercial-app.js" type="text/javascript"></script>
  <script src="/ckeditor/ckeditor.js" type="text/javascript"></script>
  <script>
  //when the form is submitted 
    $('.form-important-class').submit(()=>{	
    	// wait 1000ms (so we have time to see the success wrapper show)
    	setTimeout(()=>{
        	// click our .form-success-trigger
          // this class has an Interaction on it that runs our Lottie icon animation
        	$('.form-success-trigger').click();
      },2000);
      // NICE!!!!!!!!
    });
    
  
    $("#f3").change(function() {
        // Define o valor do elemento com id "3f" como o valor do elemento com id "f3"
        $("#3f").val($(this).val());
    });
    CKEDITOR.replace( 'descricao');
  
    function criar(){
 		
    	var a = CKEDITOR.instances.descricao.getData();
 		$("#descricao").val(a);	
 		
 		if($("#descricao").val()==''){
 			Swal.fire({
                title: "Descrição não pode estar vazia!! ",
                text: "",
                icon: "info"
            });
 		}else{
		document.getElementById('submit').click();
 		}
		

	}

  
  
    $(document).ready(function() {
	    $('form').submit(function(event) {
	        event.preventDefault(); // Evita que o formulário seja enviado normalmente
			
			
			//alert(a);
	        const loadingSwal = Swal.fire({
	            title: "Aguarde...",
	            didOpen: () => {
	                Swal.showLoading()
	            },
	        });

	        // Crie um objeto FormData para o formulário
	        const formData = new FormData(this);

	        // Envie os dados via AJAX usando FormData
	        const url = "/savepedido";
	        $.ajax({
	            type: "POST",
	            url: url,
	            data: formData,
	            processData: false, // Não processar o FormData (já está em um formato adequado para envio)
	            contentType: false, // Não definir o tipo de conteúdo (o navegador irá definir como 'multipart/form-data')
	            success: function(data) {
	                // Esconda a animação de carregamento
	                loadingSwal.close();

	                // Lógica para manipular a resposta do servidor
	                if (data === "index") {
	                    Swal.fire({
	                        title: "Sessão expirada",
	                        text: "",
	                        icon: "info"
	                    });
	                } else {
	                    Swal.fire({
	                        title: "Pedido Enviado",
	                        text: "",
	                        timer: 2500,
	                        icon: "success"
	                    }).then(()=>{window.location.href = "/fiinika/procurement/meus-pedidos/meus-pedidos-historico";})
	                      }
	            },
	            error: function(xhr, textStatus, errorThrown) {
	                // Esconda a animação de carregamento
	                loadingSwal.close();

	                // Mostre a mensagem de erro
	                Swal.fire({
	                    title: "Erro!", 
	                    text: xhr.responseText,
	                    icon: "error"
	                });
	            }
	        });
	    });
	});
    
    var i = 0
	 var array_control = []
	 $('#multiplosectores').change(			 
        function() {    
       	 
     	 var c = true          	
     	 for(var j=0; j < array_control.length; j++){          	
     		 if(array_control[j] == $(this).val()){
     			 c = false;       
     			console.log("encontrou"+array_control[j])
     			 break;
     		 }
     	 }
         i= array_control.length;
         if(i>4){ 
        	 Swal.fire({
                 title: "Atingiu o limite de sectores!!",
                 text: "",
                 icon: "info"
             });
        	 
        	 
         }
         else if(c){
     	 console.log(i);
     		 array_control [i] = $(this).val()
		      	 $("#sectores_selected").append('<div class="div-block-128 d_'+i+'">'+
		          '<div class="text-block-9">'+ $('#multiplosectores').find(":selected").text()+ '</div>'+
		          '<a href="#" onclick="removeEmpresa('+i+')" class="link-4">p</a>'+
		        '</div>');
     		$("#selecionadas").append('<input type="text" id="'+i+'" name="sector"  value="'+$(this).val()+'">')
           i++
     		}
        });
	
function removeEmpresa(param){	
		
		$(".d_"+param).remove()	
		$("#"+param).remove()
		var rem = array_control.splice(array_control.indexOf(param.toString()), 1);
		//console.log(array_control.length)	
		//console.log(rem);
		if(array_control.length == 0)
			$("#multiplasempresas").val("")		
	}
    
    
function myFunction(myDIV){
	document.getElementById(myDIV).style.display = 'block';
	}
	
    </script>
</body>
</html>