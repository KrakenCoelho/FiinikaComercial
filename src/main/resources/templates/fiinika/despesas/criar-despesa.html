<!DOCTYPE html><!--  Last Published: Thu Oct 20 2022 15:51:18 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="63262895b8a0d857415930a7" data-wf-site="63262895b8a0d849ca593091">
<head th:insert="/fragments/header :: header"></head>
<div th:insert="/fragments/script :: script" id="id_script"></div>
<body>
  <div class="mother-div">
    <div class="criar-page-mobile-menu">
      <a href="javascript:history.back()" class="back-button-wrapper w-inline-block">
        <div class="icon back">
          <div class="main-font-icon">q</div>
        </div>
      </a>
      <link rel="prefetch" href="javascript:history.back()">
      <div>
        <h1 class="criar-page-title">Criar Despesa</h1>
      </div>
    </div>

    <div class="close-flyout"></div>
    <div class="page-content-wrapper">

      

      <div th:insert="/fragments/menuAdmin :: menuAdmin"></div>      
      
      
      <div class="content">
        <section class="criar-page-section">
          <div class="container">
			              <div class="top-section-navigation">
              <a href="javascript:history.back()" class="seta-para-tras w-inline-block">
                <div class="text-block-129">q</div>
              </a>
              <div class="titulo">
                <div class="text-block-130">Criar Despesa<br></div>
              </div>
            </div>
            <div class="form-wrapper w-form">
            
              <form action="/despesas/criar" method="POST" id="form" name="wf-form-Criar-Fatura" data-name="Criar Fatura" enctype="multipart/form-data" class="form">
                <div class="form-section tighter">
                  <div class="criar-content-wrapper">
                  
                    <div class="photo-upload-input-wrapper">
                    <label for="Filtro-ano-3" class="form-field-lable">Comprovativo</label>
                    
                      <label for="foto_perfil_">
                      <div id="sem_foto" class="photo-upload-input-field">
                        <div class="icon upload-icon">
                          <div class="main-font-icon">4</div>
                        </div>
                        <div class="photo-upload-text">Clique para fazer upload</div>
                        <div class="photo-upload-text small-gray">Ficheiro deve ter menos de 1MB</div>
                      </div>
                      </label>
                      
                      <div id="com_foto" class="uploaded-photo-wrapper">
                        <div class="uploaded-photo-content">
                          <div class="uploaded-photo-div">
                            <div class="photo-contain">
                            <img id="foto_perfil" src="https://d3e54v103j8qbb.cloudfront.net/img/image-placeholder.svg" alt="">
                             <img id="img_pdf" src="/images/PDF_file_icon.svg-p-500.png" alt="" style="display:none"></div>
                          </div>
                          <div class="uploaded-photo-info">
                            <div class="div-block-3">
                              <div id="nome_foto" class="uploaded-image-name"></div>
                              <div class="uploaded-image-resolution"></div>
                            </div>
                          </div>
                        </div>
                        <div class="_3-buttons-wrapper">
                          <a href="#"  onclick="file_explorer()" class="action-button w-inline-block">
                            <div class="icon quick-action">
                               <div class="main-font-icon">w</div>
                              <div class="button-text quick-action-text">Substituir</div>
                            </div>
                          </a><!-- 
                          <a href="#" class="action-button w-inline-block">
                            <div class="icon quick-action">
                              <div class="main-font-icon">v</div>
                              <div class="button-text quick-action-text">Eliminar</div>
                            </div>
                          </a>-->
                        </div>
                      </div>
                      
                    </div>
                    
                    
                    <div class="form-field-wrapper">
                    <label for="name" class="form-field-lable">Nome</label>
                    <input type="text" class="form-text-field w-input" maxlength="256" name="nome_despesa" data-name="Field" placeholder="" id="field" required>
                    </div>
                    <div class="form-field-wrapper">
                    <label for="field-2" class="form-field-lable">Valor</label>
                    <input type="text" class="form-text-field w-input" maxlength="256" name="custo" data-name="Field 2" placeholder="KZ" id="custo_despesa" required>
                    </div>
                    
                    <div class="form-field-wrapper">
                    <label for="Filtro-ano-2" class="form-field-lable">Fornecedor</label>
                      <div><select id="field-3" name="idFornecedorfk" data-name="Field 3" class="select-field w-select" required>
                          <option value="">Selecione...</option> 
                          <option th:each="fornecedor : ${fornecedores}" th:value="${fornecedor.idFornecedor}" th:text="${fornecedor.nome_fornecedor}"></option>
                        </select>
                        
                      </div>
                    </div>
                    
                    <div class="form-field-wrapper">
                    <label for="Filtro-ano-3" class="form-field-lable">Retenção na fonte</label>
                      <div><select id="field-3" name="field-3" data-name="Field 3" class="select-field w-select">
                           <option value="">Selecione...</option>
                           <option value="Sim">Sim</option>
                           <option value="Não">Não</option>
                        </select>
                        
                      </div>
                    </div>
                    
                    <div class="form-field-wrapper">
                    <label for="Filtro-ano-3" class="form-field-lable">Motivo</label>
                      <div>
                       <select id="field-3" name="tipo_despesa" data-name="Field 3" class="select-field w-select" required>
                          <option value=""></option>
                          <option value="Compra de produto">Compra de produto</option>
                          <option value="Pagamento de Serviço">Pagamento de Serviço</option>
                          <option value="Despesa Interna">Despesa Interna</option>
                          <option value="Amortizações">Amortizações</option>
                          <option value="Pagamento de Crédito">Pagamento de Crédito</option>
                          <option value="Despesas Bancárias">Despesas Bancárias</option>
                        </select>
                        
                      </div>
                    </div>
                    
                    <div class="form-field-wrapper">
                      <label for="Filtro-ano-3" class="form-field-lable">Banco</label>
                      <div>
                      <select id="field-3" name="idContafk" data-name="Field 3" class="select-field w-select" required>
                         <option value=""></option>
                         <option th:each="conta : ${contas}" th:value="${conta.idConta}" th:text="${conta.banco}"></option>
                        </select>
                        
                      </div>
                    </div>
                    
                    <input type="file" id="foto_perfil_" onclick="file_explorer()" name="img_despesa"  accept="image/*,application/pdf" style="display: none">
                    <input type="submit" id="salvar_despesa" style="display: none">
                     <div class="create-div">
                      <a href="#" onclick=" Salvar()" class="button main w-button">Criar</a>
                    </div>
                    
                  </div>
                </div>
              </form>
              <div class="w-form-done">
                <div>Thank you! Your submission has been received!</div>
              </div>
              <div class="w-form-fail">
                <div>Oops! Something went wrong while submitting the form.</div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
  <div class="not-valid">
    <div class="text-block-116">Dimensão de ecrã não suportada...</div>
  </div>
  <script src="/js/fiinika-comercial-app.js" type="text/javascript"></script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
  <script src="/js/malsup_form.js"></script>
  <script type="text/javascript">
  
  
  // Formata preco		
  document.querySelector('#custo_despesa').addEventListener('input', moeda);
  
  function Salvar(){
	 /* if( $("#foto_perfil_").val()=="" ){
		  
		  msg = "Carregue o comprovativo da despesa!"
	      Alerta()
	      
	   }else{
			*/
		   $("#salvar_despesa").click()
		
		
	 
  }
  
  
  function file_explorer() {
      document.getElementById('foto_perfil_').click();
      document.getElementById('foto_perfil_').onchange = function() {
          fileobj = document.getElementById('foto_perfil_').files[0];
          var nome =$("#foto_perfil_").val().split("\\").pop();
          $("#nome_foto").html(nome)
      //  ajax_file_upload(fileobj);
        const file = $(this)[0].files[0]; // seleciona o arquivo do input
        const fileReader = new FileReader(); // cria o objeto FileReader
        fileReader.onloadend = function(){ // ao carregar a imagem
           var url = 'url('+fileReader.result+')';
           $("#foto_perfil").attr("src",fileReader.result); // altera o src da imagem
         // $("#foto_cliente").css("background-image",url);// altera o src da imagem
           $("#sem_foto").css("display","none")
           $("#com_foto").css("display","block")
          
      }
        
        if(file.type == "application/pdf"){
     	   $("#foto_perfil").css("display","none")     	 
     	   $("#img_pdf").css("display","block")
     	  
        }else{
        	 $("#foto_perfil").css("display","block")     	 
       	     $("#img_pdf").css("display","none")       	   
        }
        
       fileReader.readAsDataURL(file);
        $("#nome_foto_perfil").val("Something");
}
}
  function RemoveImg(){
	        $("#com_foto").css("display","none")
			console.log($("#nome_foto_perfil").val())
		}
  
  
  $(function() {
       
        $('#form').ajaxForm({
            beforeSend: function() {               
            	 showLoading();
            },
            uploadProgress: function(event, position, total, percentComplete) {
              //  var percentVal = percentComplete + '%';
              //  bar.width(percentVal);
              //  percent.html(percentVal);
              //  console.log(percentVal+"jj")
            },
            complete: function(xhr) {
                console.log(xhr);
                if(xhr.status == 404){
                	
                	              	
                }else if(xhr.status == 200){  
                	
                	if(xhr.responseText == "card_existis"){
                		msg = "Não é possível registar este ID do cartão"
                		Alerta(msg)
              		  }		
                	
	                if(xhr.responseText == "Sucesso"){
	                	msg = "Despesa criada com sucesso!"
	                	url = "/fiinika/despesas/todas-despesas"
	                	SucessoRegisto()
	                }
	                if(xhr.responseText == "logout"){
	                	msg = "Demorou demasiado tempo tem de se autenticar novamente, clique em Login."
	                	AvisoAutenticar()
	                	
	                }
                	
                }else if(xhr.status == 500){
					swal.close()
             	   msg = "Aconteceu um erro inesperado! Tente mais tarde. Caso o problema persistir contacte o suporte"
                       Error()
                }
	            	
                	
                	
               
            }
        });
    });
  
  /*
  $('input[name="fornecedores"]').change(function(e) { // Select the radio input group
	    // This returns the value of the checked radio button
	    // which triggered the event.
	    let f = $(this).val().split("="); 
	    $("#id_fornecedorfk").val(f[0] );
	    $("#id_fornecedorfk").attr("placeholder",f[1] );
	
	    // but this will return the first radio button's value,
	    // regardless of checked state of the radio group.
	  //  console.log( $('input[name="fornecedores"]').val() ); 
	
	});
  */
 </script>
</body>
</html>
